<?php $__env->startSection('content'); ?>
<!-- content-section-starts-here -->
<script type="text/javascript" charset="utf-8" src="/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="/ueditor/ueditor.all.min.js"> </script>
<script type="text/javascript" charset="utf-8" src="/ueditor/lang/zh-cn/zh-cn.js"></script>
<script type="text/javascript" charset="utf-8" src="/Home/js/myjs.js"></script>
<style>
	.like-ul{width:100%;height: 30px;padding: 3px;overflow: auto;}
	.like-ul li{list-style: none;display: inline-block;float: left;padding: 0px 5px 0px;}
	.like-ul li a{cursor: pointer;text-decoration: none;}
	.like-ul li a:hover{color: #f00;}
	.article-content p{text-indent:3em}
	.acolor{color: #f00;}
	.acolor-h{color: #4b4b4b;}
	.user-info-1{width:100%;margin-bottom: 10px;text-align: center}
	.user-info-2{line-height: 24px;font-size: 16px;margin-bottom: 2px;text-align: center}
	.user-info-2 a{text-decoration: none;cursor: pointer;display: inline-block; font-size: 14px;}
	.force-overflow .categories li{margin-top: 3px}
</style>
	<div class="main-body">
		<?php if(old("error")): ?>
		<div id="errDiv" style="position: fixed;width: 300px;left: 45%;z-index:1002;">
			<div class="alert alert-danger" style="text-align: center;font-size: 16px;">
				<p style="color: #ff0000"><?php echo e(old('error')); ?></p>
				<input type="hidden" id="editorValueHidden" value="<?php echo e(old("editorValue")); ?>">
			</div>
		</div>
		<?php endif; ?>
		<div class="wrap">
		<ol class="breadcrumb">
			  <li><a href="/">首页</a></li>
			  <li class="active">文章详情</li>
			</ol>
			<div class="single-page">
			<div class="col-md-2 share_grid">
				<h3>分享</h3>
				<ul>
					<li>
						<a href="#">
							<i class="facebook"></i>
							<div class="views">
								<span>SHARE</span>
								<label>180</label>
							</div>
							<div class="clearfix"></div>
						</a>
					</li>
					<li>
						<a href="#">
							<i class="twitter"></i>
							<div class="views">
								<span>TWEET</span>
								<label>355</label>
							</div>
							<div class="clearfix"></div>
						</a>
					</li>
					<li>
						<a href="#">
							<i class="linkedin"></i>
							<div class="views">
								<span>SHARES</span>
								<label>28</label>
							</div>
							<div class="clearfix"></div>
						</a>
					</li>
					<li>
						<a href="#">
							<i class="pinterest"></i>
							<div class="views">
								<span>PIN</span>
								<label>16</label>
							</div>
							<div class="clearfix"></div>
						</a>
					</li>
					<li>
						<a href="#">
							<i class="email"></i>
							<div class="views">
								<span>Email</span>
							</div>
							<div class="clearfix"></div>
						</a>
					</li>
				</ul>
			</div>
			<div class="col-md-6 content-left single-post">
				<div class="blog-posts">
					<h3 class="post"><?php echo e($articleInfo->article_title); ?></h3>
					<div class="last-article">
						<p class="artext">
							<?php echo e($articleInfo->article_disc); ?>

						</p>
						<br>
						<span class="article-content">
							<?php echo $articleInfo->article_content; ?>

						</span>

						<ul class="like-ul">
							<?php /*<li><a href="javascript:void(0)">浏览<?php echo e($articleInfo->views); ?></a></li>*/ ?>
							<li>
								<a class="span_link" href="javascript:void(0)">
									<span class="glyphicon glyphicon-comment"></span><?php echo e($articleInfo->comments); ?>

								</a>
								<a class="span_link" href="javascript:void(0)">
									<span class="glyphicon glyphicon-eye-open"></span><?php echo e($articleInfo->views); ?>

								</a>
								<?php if($articleInfo->isCollector > 0): ?>
									<a class="span_link collecManage" style="color: #f00" type="1" id="cancelCollection" data="<?php echo e($articleInfo->id); ?>" href="javascript:void(0)">
										<span class="glyphicon glyphicon-thumbs-up"></span><?php echo e($articleInfo->collections); ?>

									</a>
								<?php else: ?>
									<a class="span_link collecManage" type="0" id="cancelCollection" data="<?php echo e($articleInfo->id); ?>" href="javascript:void(0)">
										<span class="glyphicon glyphicon-thumbs-up"></span><?php echo e($articleInfo->collections); ?>

									</a>
								<?php endif; ?>
							</li>
							<?php /*<li><a href="javascript:void(0)">评论<?php echo e($articleInfo->comments); ?></a></li>*/ ?>
						</ul>

						<ul class="categories">
							<?php foreach($articleInfo->collector as $val): ?>
								<li><a href="#"><img style="width: 40px;height: 40px;" src="<?php echo e($val->logo); ?>" alt="<?php echo e($val->username); ?>"></a></li>
							<?php endforeach; ?>
						</ul>
						<div class="clearfix"></div>

					<div class="response">
						<?php if(count($articleComment) > 0): ?>
							<h4>评论</h4>
						<?php else: ?>
							<h4>还没评论哦~~!</h4>
						<?php endif; ?>
						<?php foreach($articleComment as $val): ?>
							<?php /*<form action="/auth/authanswer" method="post">*/ ?>
							<input type="hidden" type="text" name="_token" value="<?php echo e(csrf_token()); ?>">
							<div class="media response-info" style="position: relative">
								<div class="media-left response-text-left">
									<a href="#">
										<img class="media-object" src="<?php echo e($val->logo); ?>" alt=""/>
									</a>
									<h5><a href="#"><?php echo e($val->username); ?></a></h5>
								</div>
								<div class="media-body response-text-right">
									<p><?php echo $val->article_comment; ?></p>
									<ul>
										<li><?php echo e($val->created_at); ?></li>
										<li><a class="createedui" articleId="<?php echo e($val->article_id); ?>" commentId="<?php echo e($val->id); ?>" this-user="<?php echo e($val->user_id); ?>" href="javascript:void(0);">回复</a></li>
									</ul>
									<?php foreach($val->answer as $va): ?>
										<div class="media response-info">
											<div class="media-left response-text-left">
												<a href="#" style="width:35px">
													<img class="media-object" src="<?php echo e($val->logo); ?>" alt=""/>
												</a>
												<h5><a href="#"><?php echo e($va->from_user_name); ?></a></h5>
											</div>
											<div class="media-body response-text-right">
												<p><?php echo $va->article_comment; ?></p>
												<ul>
													<li><?php echo e($va->created_at); ?></li>
													<li><a class="createedui" articleId="<?php echo e($val->article_id); ?>" commentId="<?php echo e($val->id); ?>" this-user="<?php echo e($va->from_user_id); ?>" href="javascript:void(0);">回复</a></li>
												</ul>
											</div>
											<div class="clearfix"> </div>
										</div>
									<?php endforeach; ?>
									<div style="width: 500px;height: 500px;display: none;position: fixed;left: 390px;top:1px;z-index:1001">
										<div id="<?php echo e($val->id); ?>"></div>
										<div class="input-group mar-top" id="btndiv<?php echo e($val->id); ?>" style="margin-top: 20px;display: none">
											<input id="createedui<?php echo e($val->id); ?>" data="<?php echo e($val->id); ?>" type="button" articleid="<?php echo e($articleInfo->id); ?>" commentId="0" toUserId="0" style="margin-left: 450px" class="btn btn-primary btn-sm edui" value="回复">
										</div>
									</div>
								</div>
								<div class="clearfix"> </div>
							</div>
							<?php /*</form>*/ ?>
						<?php endforeach; ?>
					</div>

					<div class="page-class">
						<?php echo $articleComment->render(); ?>

					</div>

					<div class="coment-form">
						<form action="/auth/authcomment" method="post">
							<input type="hidden" name="articleid" value="<?php echo e($articleInfo->id); ?>">
							<input type="hidden" type="text" name="_token" value="<?php echo e(csrf_token()); ?>">
							<div class="grid_3 grid_5" id="editor"></div>
							<script>
								$(function(){
									//实例化编辑器
									//建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
									var ue = UE.getEditor('editor');
								})
							</script>
							<input type="submit" value="发布评论" >
						</form>
					</div>

					<!--related-posts-->
					<div class="row related-posts">
						<h4>你可能喜欢</h4>
						<?php foreach($articleMastInfo["want"] as $val): ?>
							<div class="col-xs-6 col-md-3 related-grids" style="width: auto">
								<a href="/article_detail/<?php echo e($val->id); ?>" class="thumbnail">
									<img style="height:130px;" src="<?php echo e($val->article_thumb); ?>" alt=""/>
								</a>
								<h5><a href="single.html"><?php echo e($val->article_title); ?></a></h5>
							</div>
						<?php endforeach; ?>
					</div>
					<!--//related-posts-->

					<div class="clearfix"></div>
				</div>
			</div>
	</div>
		<div class="col-md-4 side-bar">
			<div class="first_half">
				<div class="categories">
					<div class="user-info-1">
						<img width="200px" src="<?php echo e($articleInfo->getUsername->logo); ?>" alt="">
					</div>
					<div class="user-info-2">
						<a href=""><?php echo e($articleInfo->getUsername->username); ?></a>
					</div>
					<div class="user-info-2">
						<?php if($foucsInfo["bouth"]): ?>
							<a href="javascript:void(0)" id="foucsBouth" class="acolor">相互关注</a>
						<?php endif; ?>
						<?php if($foucsInfo["single"]): ?>
							<a href="javascript:void(0)" type="1" class="acolor isFoucs" data="<?php echo e($articleInfo->getUsername->id); ?>">取消关注</a>
						<?php else: ?>
							<a href="javascript:void(0)" type="0" class="acolor-h isFoucs" data="<?php echo e($articleInfo->getUsername->id); ?>">关注</a>
						<?php endif; ?>
					</div>
				</div>
				<div class="categories">
					<header>
						<h3 class="side-title-head">分类</h3>
					</header>
					<ul>
						<li><a href="/">综合</a></li>
						<?php foreach($cateInfo as $val): ?>
							<li><a href="/categoryarticle/<?php echo e($val->id); ?>"><?php echo e($val->category_name); ?></a></li>
						<?php endforeach; ?>
					</ul>
				</div>
				<div class="newsletter">
					<h1 class="side-title-head">Newsletter</h1>
					<p class="sign">Sign up to receive our free newsletters!</p>
					<form>
						<input type="text" class="text" value="Email Address" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Email Address';}">
						<input type="submit" value="submit">
					</form>
				</div>
				<div class="list_vertical">
					<section class="accordation_menu">
						<div>
							<h4>关于他</h4>
							<input id="label-1" name="lida" type="radio" checked/>
							<label for="label-1" id="item1"><i class="ferme"> </i>他的文章<i class="icon-plus-sign i-right1"></i><i class="icon-minus-sign i-right2"></i></label>
							<div class="content" id="a1">
								<div class="scrollbar" id="style-2">
									<div class="force-overflow">
										<?php foreach($articleMastInfo["articleHistory"] as $item): ?>
											<div class="popular-post-grids">
												<div class="popular-post-grid">
													<div class="post-img">
														<a href="/article_detail/<?php echo e($item->id); ?>"><img src="<?php echo e($item->article_thumb); ?>" alt="" /></a>
													</div>
													<div class="post-text">
														<a class="pp-title" href="/article_detail/<?php echo e($item->id); ?>"> <?php echo e($item->article_disc); ?></a>
														<p><?php echo e($item->created_at); ?>

															<a class="span_link" href="javascript:void(0)">
																<span class="glyphicon glyphicon-comment"></span><?php echo e($item->comments); ?>

															</a>
															<a class="span_link" href="javascript:void(0)">
																<span class="glyphicon glyphicon-eye-open"></span><?php echo e($item->views); ?>

															</a>
															<a class="span_link" href="javascript:void(0)">
																<span class="glyphicon glyphicon-thumbs-up"></span><?php echo e($item->collections); ?>

															</a>
														</p>
													</div>
													<div class="clearfix"></div>
												</div>
											</div>
										<?php endforeach; ?>
										<?php if(count($articleMastInfo["articleHistory"])==0): ?>
												<div class="article" style="text-align: center">
													<h4><a href="/articles">他并没有发布过文章~！</a></h4>
												</div>
										<?php endif; ?>
									</div>
                                </div>
                              </div>
					 	</div>
						<div>
							  <input id="label-2" name="lida" type="radio"/>
							  <label for="label-2" id="item2"><i class="icon-leaf" id="i2"></i>他的粉丝<i class="icon-plus-sign i-right1"></i><i class="icon-minus-sign i-right2"></i></label>
							  <div class="content" id="a2">
								  <div class="scrollbar" id="style-2">
									  <div class="force-overflow">
										  <ul class="categories">
											  <?php foreach($articleMastInfo["fans"] as $val): ?>
												  <li>
													  <a href="#">
														  <img style="width: 40px;height: 40px;" src="<?php echo e($val->logo); ?>" alt="<?php echo e($val->username); ?>">
													  		<?php echo e($val->username); ?>

													  </a>
												  </li>
											  <?php endforeach; ?>
											  <?php if(count($articleMastInfo["fans"])==0): ?>
												  <div class="article" style="text-align: center">
													  <h4><a href="/articles">这个丑逼并没有粉丝~！</a></h4>
												  </div>
											  <?php endif; ?>
										  </ul>
									  </div>
								  </div>
							  </div>
						</div>
						<div>
							<input id="label-3" name="lida" type="radio"/>
							<label for="label-3" id="item3"><i class="icon-trophy" id="i3"></i>他关注了<i class="icon-plus-sign i-right1"></i><i class="icon-minus-sign i-right2"></i></label>
							<div class="content" id="a3">
								<div class="scrollbar" id="style-2">
									<div class="force-overflow">
										<ul class="categories">
										<?php foreach($articleMastInfo["foucs"] as $val): ?>
											<li>
												<a href="#">
													<img style="width: 40px;height: 40px;" src="<?php echo e($val->logo); ?>" alt="<?php echo e($val->username); ?>">
													<?php echo e($val->username); ?>

												</a>
											</li>
										<?php endforeach; ?>
										</ul>
										<?php if(count($articleMastInfo["foucs"])==0): ?>
											<div class="article" style="text-align: center">
												<h4><a href="/articles">这个丑逼并没有关注任何人~！</a></h4>
											</div>
										<?php endif; ?>
									</div>
							   </div>
							</div>
						</div>
					</section>
				</div>
		  </div>

		 <?php /*<div class="secound_half">*/ ?>
			 <?php /*<div class="tags">*/ ?>
				<?php /*<header>*/ ?>
					<?php /*<h3 class="title-head">Tags</h3>*/ ?>
				<?php /*</header>*/ ?>
				<?php /*<p>*/ ?>
				<?php /*<a class="tag1" href="single.html">At vero eos</a>*/ ?>
				<?php /*<a class="tag2" href="single.html">doloremque</a>*/ ?>
				<?php /*<a class="tag3" href="single.html">On the other</a>*/ ?>
				<?php /*<a class="tag4" href="single.html">pain was</a>*/ ?>
				<?php /*<a class="tag5" href="single.html">rationally encounter</a>*/ ?>
				<?php /*<a class="tag6" href="single.html">praesentium voluptatum</a>*/ ?>
				<?php /*<a class="tag7" href="single.html">est, omnis</a>*/ ?>
				<?php /*<a class="tag8" href="single.html">who are so beguiled</a>*/ ?>
				<?php /*<a class="tag9" href="single.html">when nothing</a>*/ ?>
				<?php /*<a class="tag10" href="single.html">owing to the</a>*/ ?>
				<?php /*<a class="tag11" href="single.html">pains to avoid</a>*/ ?>
				<?php /*<a class="tag12" href="single.html">tempora incidunt</a>*/ ?>
				<?php /*<a class="tag13" href="single.html">pursues or desires</a>*/ ?>
				<?php /*<a class="tag14" href="single.html">Bonorum et</a>*/ ?>
				<?php /*<a class="tag15" href="single.html">written by Cicero</a>*/ ?>
				<?php /*<a class="tag16" href="single.html">Ipsum passage</a>*/ ?>
				<?php /*<a class="tag17" href="single.html">exercitationem ullam</a>*/ ?>
				<?php /*<a class="tag18" href="single.html">mistaken idea</a>*/ ?>
				<?php /*<a class="tag19" href="single.html">ducimus qui</a>*/ ?>
				<?php /*<a class="tag20" href="single.html">holds in these</a>*/ ?>
				<?php /*</p>*/ ?>
			 <?php /*</div>*/ ?>
			 <?php /*<div class="popular-news">*/ ?>
				<?php /*<header>*/ ?>
					<?php /*<h3 class="title-popular">popular News</h3>*/ ?>
				<?php /*</header>*/ ?>
				<?php /*<div class="popular-grids">*/ ?>
					<?php /*<div class="popular-grid">*/ ?>
						<?php /*<a href="single.html"><img src="images/popular-4.jpg" alt="" /></a>*/ ?>
						<?php /*<a class="title" href="single.html">It is a long established fact that a reader will be distracted</a>*/ ?>
						<?php /*<p>On Aug 31, 2015 <a class="span_link" href="#"><span class="glyphicon glyphicon-comment"></span>0 </a><a class="span_link" href="#"><span class="glyphicon glyphicon-eye-open"></span>250 </a><a class="span_link" href="#"><span class="glyphicon glyphicon-thumbs-up"></span>68</a></p>*/ ?>
					<?php /*</div>*/ ?>
					<?php /*<div class="popular-grid">*/ ?>
						<?php /*<a class="title" href="single.html">Aishwarya Rai Bachchan's Latest SHOCKING News For Ex Salman Khan</a>*/ ?>
						<?php /*<p>On Mar 14, 2015 <a class="span_link" href="#"><span class="glyphicon glyphicon-comment"></span>0 </a><a class="span_link" href="#"><span class="glyphicon glyphicon-eye-open"></span>250 </a><a class="span_link" href="#"><span class="glyphicon glyphicon-thumbs-up"></span>68</a></p>*/ ?>
					<?php /*</div>*/ ?>
					<?php /*<div class="popular-grid">*/ ?>
						<?php /*<a href="single.html"><img src="images/popular-3.jpg" alt="" /></a>*/ ?>
						<?php /*<a class="title" href="single.html">It is a long established fact that a reader will be distracted</a>*/ ?>
						<?php /*<p>On Mar 14, 2015 <a class="span_link" href="#"><span class="glyphicon glyphicon-comment"></span>0 </a><a class="span_link" href="#"><span class="glyphicon glyphicon-eye-open"></span>250 </a><a class="span_link" href="#"><span class="glyphicon glyphicon-thumbs-up"></span>68</a></p>*/ ?>
					<?php /*</div>*/ ?>
				<?php /*</div>*/ ?>
			<?php /*</div>*/ ?>
		<?php /*</div>*/ ?>
		 <div class="clearfix"></div>
	</div>
	<div class="clearfix"></div>
	</div>
	</div>
	</div>
	<!-- content-section-ends-here -->
	<script>
		$(function() {
			var idRember = new Array();
			$(".createedui").click(function(){
				id = $(this).attr("commentId");
				thisClass = $("#"+id).attr("class");
				thisUser = $(this).attr("this-user");
				if(thisClass == "edui-default"){
					UE.getEditor(id).setShow();
					//$("#answerBtnDiv").show();
				}else{
					docuHeight = (parseInt($(window).height()) - 400) / 2;
					docuWidth = parseInt($(this).offset().left) - 500;
					$("#"+id).parent().css({"top":docuHeight+"px","left":docuWidth+"px"}).show();
					var ue = UE.getEditor(id);
					idRember.push(id);
				}
				$("#createedui"+id).attr("commentId",id).attr("toUserId",thisUser);
				$("#btndiv"+id).show();
			});

			$(document).bind("click",function(e){
				classNameClicker = $(e.target).attr("class") === undefined ? "" : $(e.target).attr("class");
				if(classNameClicker.indexOf("edui") > -1){
					return;
				}else{
					for(var i in idRember){
						UE.getEditor(idRember[i]).setHide()
						$("#btndiv"+idRember[i]).hide();
					}
				}
			});

			$(".btn-primary").click(function(){
				if(!UE.getEditor($(this).attr("data")).getContent()){
					alert("内容不能为空");return;
				}
				var formData = '<div sytle="display:none"><form action="/auth/authanswer" method="post">';
				formData += '<input type="hidden" name="article_id" value="'+ $(this).attr("articleid") +'">';
				formData += '<input type="hidden" name="comment_id" value="'+ $(this).attr("commentid") +'">';
				formData += '<input type="hidden" name="to_user_id" value="'+ $(this).attr("touserid") +'">';
				formData += '<input type="hidden" name="_token" value="<?php echo e(csrf_token()); ?>">';
				formData += '<input type="hidden" name="article_comment" value="'+ UE.getEditor($(this).attr("data")).getContent() +'">';
				formData += '<input type="submit" id="subid">'
				formData += '</form></div>';
				//$(formData).submit(); //火狐浏览器不支持这种方法  改为下面
				$("body").append(formData);
				$("#subid").trigger("click");
				return true;
				//ajax 方法
				var formDataSerialize = $(formData).serialize();
				para = 'calbackFunction';
				$.phpajax('/auth/authanswer','post',formDataSerialize,true,"json",para);
			});


			$(".collecManage").click(function(){
				articleId = $(this).attr("data");
				type = $(this).attr("type");
				articleId = $(this).attr("data");
				formData = '<form>';
				formData += '<input type="hidden" name="article_id" value="'+ articleId +'">';
				formData += '<input type="hidden" name="_token" value="<?php echo e(csrf_token()); ?>">';
				formData += '</form>';
				formDataSerialize = $(formData).serialize();
				if(type == 1){
					//取消点赞
					$.phpajax("/auth/colletioncancel","post",formDataSerialize,true,"json","collectionCallBack");
				}else{
					//点赞
					$.phpajax("/auth/colletion","post",formDataSerialize,true,"json","collectionCallBack");
				}
			});

			$(".isFoucs").click(function(){
				userId = $(this).attr("data");
				type = $(this).attr("type");
				type == 1 ? $.phpajax("/auth/foucsusercancle/"+userId,"get","",true,"json","foucsCallback") : $.phpajax("/auth/foucsuser/"+userId,"get","",true,"json","foucsCallback");
			});

			<?php if(old("error")): ?>
			setTimeout(function(){
				$("#errDiv").hide();
				UE.getEditor('editor').setContent($("#editorValueHidden").val(), 0);
			},2000)
			<?php endif; ?>
		});

		function foucsCallback(data){
			if(data.status == -1){
				alert(data.message);return;
			}else if (data.status == -2){
				if(confirm("请先登录后进行操作")){
					window.location.href = "/auth/login";
				}
			}else{
				type = $(".isFoucs").attr("type");
				ext = data.ext;
				//<a href="javascript:void(0)" class="acolor">相互关注</a>  user-info-2
				type == 0 ? $(".isFoucs").before('<a id="foucsBouth" href="javascript:void(0)" class="acolor">相互关注</a> ') : $("#foucsBouth").remove();
				type == 0 ? $(".isFoucs").attr("type",1).removeClass("acolor-h").addClass("acolor").text("取消关注") : $(".isFoucs").attr("type",0).removeClass("acolor").addClass("acolor-h").text("关注");
			}
		}

		function collectionCallBack(data){
			if(data.status == -1){
				alert(data.message);return;
			}else if(data.status == -2){
				window.location.href = "/auth/login";
			}else{
				str = '<span class="glyphicon glyphicon-thumbs-up"></span>' + data.ext;
				type = $(".collecManage").attr("type");
				type == 0 ? $(".collecManage").attr("type",1).html(str).css({"color":"#F00"}) : $(".collecManage").attr("type",0).removeClass("acolor").html(str).css({"color":"#C5C5C5"});
			}
		}
	</script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('Home.header', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>